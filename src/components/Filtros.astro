---
const provincias = [
  "Pinar del Río", "Artemisa", "La Habana", "Mayabeque", "Matanzas", 
  "Villa Clara", "Cienfuegos", "Sancti Spíritus", "Ciego de Ávila", 
  "Camagüey", "Las Tunas", "Holguín", "Granma", "Santiago de Cuba", 
  "Guantánamo", "Isla de la Juventud"
];

const categorias = [
  "Gastronomía", "Alojamiento", "Reparaciones", "Transporte", 
  "Belleza", "Salud", "Educación", "Tecnología", "Construcción", 
  "Eventos", "Comercio", "Asesoría Legal", "Artesanía", "Limpieza"
];
---

<div class="bg-white rounded-lg shadow-md p-6 mb-6">
  <h2 class="text-xl font-semibold mb-4 text-gray-800 flex items-center">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-emerald-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" />
    </svg>
    Filtros de búsqueda
  </h2>
  
  <form id="filtros-form" class="space-y-4">
    <div>
      <label for="busqueda" class="block text-sm font-medium text-gray-700 mb-1">Palabra clave</label>
      <div class="relative">
        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
          </svg>
        </div>
        <input
          type="text"
          id="busqueda"
          name="busqueda"
          placeholder="¿Qué servicio buscas?"
          class="w-full pl-10 px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 bg-white text-gray-800"
        />
      </div>
    </div>
    
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <label for="provincia" class="block text-sm font-medium text-gray-700 mb-1">Provincia</label>
        <div class="relative">
          <select
            id="provincia"
            name="provincia"
            class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 bg-white text-gray-800 appearance-none pr-8"
          >
            <option value="">Todas las provincias</option>
            {provincias.map((provincia) => (
              <option value={provincia}>{provincia}</option>
            ))}
          </select>
          <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
            <svg class="h-4 w-4 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </div>
        </div>
      </div>
      
      <div>
        <label for="municipio" class="block text-sm font-medium text-gray-700 mb-1">Municipio</label>
        <div class="relative">
          <select
            id="municipio"
            name="municipio"
            class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 bg-white text-gray-800 appearance-none pr-8 disabled:bg-gray-100 disabled:text-gray-500"
            disabled
          >
            <option value="">Selecciona una provincia primero</option>
          </select>
          <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
            <svg class="h-4 w-4 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </div>
        </div>
      </div>
    </div>
    
    <div>
      <label for="categoria" class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
      <div class="relative">
        <select
          id="categoria"
          name="categoria"
          class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 bg-white text-gray-800 appearance-none pr-8"
        >
          <option value="">Todas las categorías</option>
          {categorias.map((categoria) => (
            <option value={categoria}>{categoria}</option>
          ))}
        </select>
        <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
          <svg class="h-4 w-4 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
          </svg>
        </div>
      </div>
    </div>
    
    <div>
      <label for="distancia" class="block text-sm font-medium text-gray-700 mb-1">
        Distancia máxima: <span id="distancia-valor" class="font-medium text-emerald-600">5</span> km
      </label>
      <input
        type="range"
        id="distancia"
        name="distancia"
        min="1"
        max="50"
        value="5"
        class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-emerald-500"
      />
      <div class="flex justify-between text-xs text-gray-500 px-1 mt-1">
        <span>1 km</span>
        <span>25 km</span>
        <span>50 km</span>
      </div>
    </div>
    
    <div class="flex flex-col sm:flex-row sm:justify-between gap-3 pt-2">
      <button
        type="reset"
        class="px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 text-sm font-medium"
      >
        Limpiar filtros
      </button>
      
      <button
        type="submit"
        class="px-5 py-2 bg-emerald-600 text-white rounded-md hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 text-sm font-medium flex items-center justify-center"
      >
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
        </svg>
        Buscar
      </button>
    </div>
  </form>
</div>

<script>
  // Datos de municipios por provincia
  const municipiosPorProvincia: Record<string, string[]> = {
    "Pinar del Río": ["Consolación del Sur", "Guane", "La Palma", "Los Palacios", "Mantua", "Minas de Matahambre", "Pinar del Río", "San Juan y Martínez", "San Luis", "Sandino", "Viñales"],
    "Artemisa": ["Alquízar", "Artemisa", "Bauta", "Caimito", "Guanajay", "Güira de Melena", "Mariel", "San Antonio de los Baños", "Bahía Honda", "Candelaria", "San Cristóbal"],
    "La Habana": ["Arroyo Naranjo", "Boyeros", "Centro Habana", "Cerro", "Cotorro", "Diez de Octubre", "Guanabacoa", "Habana del Este", "Habana Vieja", "La Lisa", "Marianao", "Playa", "Plaza de la Revolución", "Regla", "San Miguel del Padrón"],
    // Aquí se añadirían los municipios de las demás provincias
  };

  // Actualizar el selector de municipios cuando cambia la provincia
  const provinciaSelect = document.getElementById('provincia') as HTMLSelectElement;
  const municipioSelect = document.getElementById('municipio') as HTMLSelectElement;
  
  if (provinciaSelect && municipioSelect) {
    provinciaSelect.addEventListener('change', () => {
      const provinciaSeleccionada = provinciaSelect.value;
      
      // Limpiar opciones actuales
      municipioSelect.innerHTML = '';
      
      if (provinciaSeleccionada) {
        // Habilitar selector de municipios
        municipioSelect.disabled = false;
        
        // Añadir opción por defecto
        const defaultOption = document.createElement('option');
        defaultOption.value = '';
        defaultOption.textContent = 'Todos los municipios';
        municipioSelect.appendChild(defaultOption);
        
        // Añadir municipios de la provincia seleccionada
        const municipios = municipiosPorProvincia[provinciaSeleccionada] || [];
        municipios.forEach((municipio: string) => {
          const option = document.createElement('option');
          option.value = municipio;
          option.textContent = municipio;
          municipioSelect.appendChild(option);
        });
      } else {
        // Si no hay provincia seleccionada, desactivar el selector
        municipioSelect.disabled = true;
        
        const defaultOption = document.createElement('option');
        defaultOption.value = '';
        defaultOption.textContent = 'Selecciona una provincia primero';
        municipioSelect.appendChild(defaultOption);
      }
    });
  }

  // Actualizar el valor mostrado del slider de distancia
  const distanciaSlider = document.getElementById('distancia') as HTMLInputElement;
  const distanciaValor = document.getElementById('distancia-valor');
  
  if (distanciaSlider && distanciaValor) {
    distanciaSlider.addEventListener('input', () => {
      if (distanciaValor.textContent !== null) {
        distanciaValor.textContent = distanciaSlider.value;
      }
    });
  }
  
  // Manejar el botón de reset
  const formFiltros = document.getElementById('filtros-form');
  if (formFiltros) {
    formFiltros.addEventListener('reset', () => {
      // Esperar al próximo ciclo para que los valores se reseteen primero
      setTimeout(() => {
        if (distanciaValor && distanciaValor.textContent !== null) {
          distanciaValor.textContent = '5';
        }
        if (municipioSelect) {
          municipioSelect.disabled = true;
          municipioSelect.innerHTML = '';
          const defaultOption = document.createElement('option');
          defaultOption.value = '';
          defaultOption.textContent = 'Selecciona una provincia primero';
          municipioSelect.appendChild(defaultOption);
        }
      }, 0);
    });
  }
</script> 