import{_ as D,S as v,a as N,b as k,c as b,d as i}from"./select.156891fc.js";import{j as e}from"./utils.4700314a.js";import{r as t}from"./index.ba1407fb.js";import{C as S,a as B}from"./card.76bb78a3.js";import{B as E}from"./badge.5aff5ef2.js";import{B as f}from"./button.24a09aef.js";import{S as C}from"./skeleton.616cc4ae.js";import"./input.38b38b9a.js";import{a as I,b as P}from"./data.a7dc0bf8.js";import{c as p}from"./createLucideIcon.5c021b84.js";import{S as M}from"./star.89c249e4.js";import{M as U}from"./menu.a2555d40.js";import{M as O}from"./map-pin.d67ea25f.js";import"./index.5c5fab55.js";import"./index.bc1dd6cd.js";import"./index.14f11eed.js";import"./index.aa7e84ef.js";import"./index.39b6438a.js";import"./index.2ab59327.js";import"./index.2229f0e2.js";import"./index.6af11c90.js";import"./index.0a899574.js";import"./index.40f1a6dd.js";import"./index.7640c394.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"m21 8-4-4-4 4",key:"1c9v7m"}],["path",{d:"M17 4v16",key:"7dpous"}]],Q=p("ArrowDownUp",G);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]],H=p("Filter",Z);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],K=p("Grid3x3",J);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],X=p("List",W);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ee=p("LocateFixed",Y),re=t.lazy(()=>D(()=>import("./map-view.ef0a5a2e.js"),["_astro/map-view.ef0a5a2e.js","_astro/utils.4700314a.js","_astro/index.ba1407fb.js","_astro/skeleton.616cc4ae.js","_astro/button.24a09aef.js","_astro/index.aa7e84ef.js","_astro/index.7640c394.js","_astro/badge.5aff5ef2.js","_astro/index.2229f0e2.js","_astro/index.5c5fab55.js","_astro/map-pin.d67ea25f.js","_astro/createLucideIcon.5c021b84.js","_astro/register.4d8e306f.css"]));async function se(r){await new Promise(a=>setTimeout(a,800));let l=P.filter(a=>(a.name.toLowerCase().includes(r.query.toLowerCase())||a.category.toLowerCase().includes(r.query.toLowerCase())||a.description.toLowerCase().includes(r.query.toLowerCase()))&&(r.category==="Todas"||a.category===r.category)&&(r.rating==="0"||a.rating>=parseInt(r.rating)));return r.sortBy==="rating"?l.sort((a,o)=>a.promoted!==o.promoted?a.promoted?-1:1:o.rating-a.rating||a.name.localeCompare(o.name)):r.sortBy==="name"?l.sort((a,o)=>a.promoted!==o.promoted?a.promoted?-1:1:a.name.localeCompare(o.name)):l.sort((a,o)=>a.promoted!==o.promoted?a.promoted?-1:1:0),l}function ae({business:r}){return e.jsx(S,{className:`overflow-hidden group relative border-primary/10 bg-card/80 backdrop-blur-sm rounded-xl \r
      shadow-sm hover:shadow-md hover:shadow-primary/5 transition-all duration-300 flex flex-col\r
      hover:scale-[1.02] hover:-translate-y-1`,children:e.jsxs("a",{href:`/business/${r.id}`,className:"block",children:[e.jsxs("div",{className:"relative aspect-square",children:[e.jsx("img",{src:r.image,alt:r.name,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-primary/30 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),r.promoted&&e.jsx("div",{className:"absolute top-2 right-2 animate-orbit-small",children:e.jsx(E,{className:`bg-primary/90 hover:bg-primary text-primary-foreground text-[8px] md:text-[10px] px-1.5 py-0.5 \r
                rounded-full shadow-lg shadow-primary/20 border-none backdrop-blur-sm`,children:"★ DESTACADO"})})]}),e.jsxs(B,{className:"p-2 md:p-3 flex-grow flex flex-col justify-end",children:[e.jsx("h3",{className:"font-semibold text-xs md:text-sm truncate group-hover:text-primary transition-colors",children:r.name}),e.jsxs("div",{className:"flex items-center gap-1 text-[10px] md:text-xs mt-0.5",children:[e.jsx(M,{className:"h-3 w-3 text-yellow-500 fill-current"}),e.jsx("span",{className:"font-medium",children:r.rating.toFixed(1)}),e.jsx("span",{className:"text-primary/40",children:"•"}),e.jsx("span",{className:"text-muted-foreground truncate",children:r.category})]})]})]})})}function te({business:r}){return e.jsx(S,{className:`overflow-hidden group relative border-primary/10 bg-card/80 backdrop-blur-sm rounded-xl \r
      shadow-sm hover:shadow-md hover:shadow-primary/5 transition-all duration-300\r
      hover:scale-[1.01] hover:-translate-y-1`,children:e.jsxs("a",{href:`/business/${r.id}`,className:"flex flex-col md:flex-row",children:[e.jsxs("div",{className:"relative md:w-[120px] lg:w-[150px]",children:[e.jsxs("div",{className:"aspect-square md:h-full",children:[e.jsx("img",{src:r.image,alt:r.name,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-primary/30 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),r.promoted&&e.jsx("div",{className:"absolute top-2 right-2 animate-orbit-small",children:e.jsx(E,{className:`bg-primary/90 hover:bg-primary text-primary-foreground text-[8px] md:text-[10px] px-1.5 py-0.5 \r
                rounded-full shadow-lg shadow-primary/20 border-none backdrop-blur-sm`,children:"★ DESTACADO"})})]}),e.jsxs(B,{className:"p-3 flex-grow md:w-auto",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-xs md:text-sm truncate group-hover:text-primary transition-colors",children:r.name}),e.jsxs("div",{className:"flex items-center gap-1 text-[9px] md:text-xs mt-0.5",children:[e.jsx("span",{className:"text-muted-foreground truncate",children:r.category}),e.jsx("span",{className:"text-primary/40",children:"•"}),e.jsx(O,{className:"h-3 w-3"})," ",e.jsx("span",{className:"truncate",children:r.location})]})]}),e.jsxs("div",{className:"flex items-center gap-0.5 text-yellow-500",children:[e.jsx(M,{className:"h-3 w-3 fill-current"}),e.jsx("span",{className:"font-medium text-foreground",children:r.rating.toFixed(1)})]})]}),r.description&&e.jsx("p",{className:"text-[9px] md:text-xs text-muted-foreground pt-1 line-clamp-1",children:r.description})]})]})})}function _e(){const[r,l]=t.useState(""),[a,o]=t.useState("Todas"),[m,h]=t.useState("0"),[x,y]=t.useState("rating"),[n,u]=t.useState(!1),[c,j]=t.useState("grid"),[g,L]=t.useState([]),[V,_]=t.useState(!0),[q,R]=t.useState(!1);t.useEffect(()=>{R(!0)},[]),t.useEffect(()=>{try{const s=new URLSearchParams(window.location.search),d=s.get("query")||"",w=s.get("category")||"Todas",A=s.get("rating")||"0",$=s.get("sort")||"rating",F=s.get("view")||"list",z=s.get("viewMode")||"grid";l(d),o(w),h(A),y($),u(F==="map"),j(z)}catch(s){console.error("Error al procesar parámetros de URL:",s),l(""),o("Todas"),h("0"),y("rating"),u(!1),j("grid")}},[]),t.useEffect(()=>{async function s(){try{_(!0);const w=await se({query:r,category:a,rating:m,sortBy:x});L(w)}catch(d){console.error("Error al cargar los negocios:",d),L([])}finally{_(!1)}}s()},[r,a,m,x]),t.useEffect(()=>{try{const s=new URLSearchParams;r&&s.set("query",r),s.set("category",a),s.set("rating",m),s.set("sort",x),s.set("view",n?"map":"list"),s.set("viewMode",c),window.history.replaceState(null,"",`${window.location.pathname}?${s.toString()}`)}catch(s){console.error("Error al actualizar la URL:",s)}},[r,a,m,x,n,c]);const T=()=>{j(c==="grid"?"list":"grid")};return e.jsxs("div",{className:"max-w-6xl mx-auto px-4 space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 p-4 bg-muted/50 rounded-lg border",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[e.jsx(H,{className:"h-5 w-5 text-muted-foreground hidden md:inline"}),e.jsxs(v,{value:a,onValueChange:o,children:[e.jsx(N,{className:"w-full sm:w-[180px] bg-background",children:e.jsx(k,{placeholder:"Categoría"})}),e.jsx(b,{children:I.map(s=>e.jsx(i,{value:s,children:s},s))})]}),e.jsxs(v,{value:m,onValueChange:h,children:[e.jsxs(N,{className:"w-full sm:w-[170px] bg-background",children:[e.jsx(M,{className:"h-4 w-4 mr-1 inline-block text-yellow-500 fill-current"}),e.jsx(k,{placeholder:"Valoración"})]}),e.jsxs(b,{children:[e.jsx(i,{value:"0",children:"Cualquiera"}),e.jsx(i,{value:"4",children:"4+ Estrellas"}),e.jsx(i,{value:"3",children:"3+ Estrellas"}),e.jsx(i,{value:"2",children:"2+ Estrellas"}),e.jsx(i,{value:"1",children:"1+ Estrellas"})]})]}),e.jsxs(v,{value:x,onValueChange:y,children:[e.jsxs(N,{className:"w-full sm:w-[160px] bg-background",children:[e.jsx(Q,{className:"h-4 w-4 mr-1 inline-block"}),e.jsx(k,{placeholder:"Ordenar por"})]}),e.jsxs(b,{children:[e.jsx(i,{value:"rating",children:"Valoración"}),e.jsx(i,{value:"name",children:"Nombre (A-Z)"})]})]})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[!n&&e.jsx(f,{variant:c==="grid"?"default":"outline",onClick:T,className:"flex-1 md:flex-initial",children:c==="grid"?e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"mr-2 h-4 w-4"})," Cuadrícula"]}):e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"mr-2 h-4 w-4"})," Lista"]})}),e.jsxs(f,{variant:n?"outline":"default",onClick:()=>{u(!1)},className:`flex-1 md:flex-initial ${n?"":"hidden"}`,children:[e.jsx(X,{className:"mr-2 h-4 w-4"})," Resultados"]}),e.jsxs(f,{variant:n?"default":"outline",onClick:()=>u(!0),className:"flex-1 md:flex-initial",children:[e.jsx(ee,{className:"mr-2 h-4 w-4"})," Mapa"]})]})]}),n?e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4 sr-only",children:"Vista de Mapa"}),e.jsx(S,{className:"h-[500px] flex items-center justify-center bg-muted text-muted-foreground rounded-lg overflow-hidden border",children:q?e.jsx(t.Suspense,{fallback:e.jsx(C,{className:"h-[500px] w-full rounded-lg"}),children:e.jsx(re,{businesses:g})}):e.jsx(C,{className:"h-[500px] w-full rounded-lg"})})]}):e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-6 sr-only",children:"Resultados"}),V?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3 md:gap-4",children:[...Array(10)].map((s,d)=>e.jsx(C,{className:"h-56 rounded-lg"},d))}):g.length>0?c==="grid"?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3 md:gap-4",children:g.map(s=>e.jsx(ae,{business:s},s.id))}):e.jsx("div",{className:"flex flex-col gap-4",children:g.map(s=>e.jsx(te,{business:s},s.id))}):e.jsxs("div",{className:"py-12 text-center",children:[e.jsx("p",{className:"text-lg text-muted-foreground",children:"No se encontraron negocios con los filtros seleccionados."}),e.jsx(f,{onClick:()=>{l(""),o("Todas"),h("0")},variant:"link",className:"mt-2",children:"Limpiar filtros"})]})]})]})}export{_e as default};
