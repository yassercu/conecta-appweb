import{_ as P,S as N,a as k,b as C,c as S,d as i}from"./select.9b2afbd2.js";import{j as e}from"./utils.1a4f1886.js";import{r as a}from"./index.a383d3d5.js";import{C as L,a as E,c as V}from"./card.9cf3ca2d.js";import{B as j}from"./badge.347109ca.js";import{B as f}from"./button.45d40932.js";import{S as M}from"./skeleton.984bc931.js";import"./input.10ac0355.js";import{a as U,b as O}from"./data.5d7ee7d8.js";import{c as h}from"./createLucideIcon.42681ef6.js";import{S as b}from"./star.5e8e837f.js";import{M as G}from"./menu.e5f269da.js";import{M as R}from"./map-pin.2cbc7465.js";import"./index.4dc25dbf.js";import"./index.34d7b91a.js";import"./Combination.0f3a16b0.js";import"./index.a27a3ea7.js";import"./index.3cab87fc.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"m21 8-4-4-4 4",key:"1c9v7m"}],["path",{d:"M17 4v16",key:"7dpous"}]],Z=h("ArrowDownUp",Q);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]],J=h("Filter",H);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],W=h("Grid3x3",K);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],Y=h("List",X);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],se=h("LocateFixed",ee),re=a.lazy(()=>P(()=>import("./map-view.39618eb0.js"),["_astro/map-view.39618eb0.js","_astro/utils.1a4f1886.js","_astro/index.a383d3d5.js","_astro/skeleton.984bc931.js","_astro/button.45d40932.js","_astro/index.3cab87fc.js","_astro/badge.347109ca.js","_astro/index.a27a3ea7.js","_astro/index.4dc25dbf.js","_astro/map-pin.2cbc7465.js","_astro/createLucideIcon.42681ef6.js","_astro/register.4d8e306f.css"]));async function te(s){await new Promise(t=>setTimeout(t,800));let o=O.filter(t=>(t.name.toLowerCase().includes(s.query.toLowerCase())||t.category.toLowerCase().includes(s.query.toLowerCase())||t.description.toLowerCase().includes(s.query.toLowerCase()))&&(s.category==="Todas"||t.category===s.category)&&(s.rating==="0"||t.rating>=parseInt(s.rating)));return s.sortBy==="rating"?o.sort((t,l)=>t.promoted!==l.promoted?t.promoted?-1:1:l.rating-t.rating||t.name.localeCompare(l.name)):s.sortBy==="name"?o.sort((t,l)=>t.promoted!==l.promoted?t.promoted?-1:1:t.name.localeCompare(l.name)):o.sort((t,l)=>t.promoted!==l.promoted?t.promoted?-1:1:0),o}function ae({business:s}){return e.jsx(L,{className:"overflow-hidden group relative border bg-card rounded-lg shadow-md hover:shadow-xl transition-shadow duration-300 flex flex-col",children:e.jsxs("a",{href:`/business/${s.id}`,className:"block",children:[e.jsxs("div",{className:"relative aspect-video",children:[e.jsx("img",{src:s.image,alt:s.name,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"}),s.promoted&&e.jsx(j,{className:"absolute top-2 right-2 bg-yellow-500 text-black text-[10px] px-1.5 py-0.5 z-10 shadow-sm border border-yellow-600",children:"★ DESTACADO"})]}),e.jsxs(E,{className:"p-4 flex-grow space-y-1",children:[e.jsx(V,{className:"text-lg font-semibold text-card-foreground",children:s.name}),e.jsx(j,{variant:"secondary",className:"text-xs",children:s.category}),e.jsxs("div",{className:"flex justify-between items-center text-sm text-muted-foreground pt-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(R,{className:"h-4 w-4"})," ",s.location]}),e.jsxs("div",{className:"flex items-center gap-1 text-yellow-500",children:[e.jsx(b,{className:"h-4 w-4 fill-current"}),e.jsx("span",{className:"font-medium text-foreground",children:s.rating.toFixed(1)})]})]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground pt-2 line-clamp-2",children:s.description})]})]})})}function le({business:s}){return e.jsx(L,{className:"overflow-hidden group relative border bg-card rounded-lg shadow-md hover:shadow-xl transition-shadow duration-300",children:e.jsxs("a",{href:`/business/${s.id}`,className:"flex flex-col md:flex-row",children:[e.jsxs("div",{className:"relative md:w-1/3 lg:w-1/4",children:[e.jsx("div",{className:"aspect-video md:h-full",children:e.jsx("img",{src:s.image,alt:s.name,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"})}),s.promoted&&e.jsx(j,{className:"absolute top-2 right-2 bg-yellow-500 text-black text-[10px] px-1.5 py-0.5 z-10 shadow-sm border border-yellow-600",children:"★ DESTACADO"})]}),e.jsxs(E,{className:"p-4 flex-grow space-y-1 md:w-2/3 lg:w-3/4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(V,{className:"text-lg font-semibold text-card-foreground",children:s.name}),e.jsx(j,{variant:"secondary",className:"text-xs mt-1",children:s.category})]}),e.jsxs("div",{className:"flex items-center gap-1 text-yellow-500",children:[e.jsx(b,{className:"h-4 w-4 fill-current"}),e.jsx("span",{className:"font-medium text-foreground",children:s.rating.toFixed(1)})]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground pt-1",children:[e.jsx(R,{className:"h-4 w-4"})," ",s.location]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground pt-2 line-clamp-2",children:s.description})]})]})})}function Ce(){const[s,o]=a.useState(""),[t,l]=a.useState("Todas"),[m,u]=a.useState("0"),[x,w]=a.useState("rating"),[c,p]=a.useState(!1),[n,y]=a.useState("grid"),[g,_]=a.useState([]),[T,B]=a.useState(!0),[q,z]=a.useState(!1);a.useEffect(()=>{z(!0)},[]),a.useEffect(()=>{try{const r=new URLSearchParams(window.location.search),d=r.get("query")||"",v=r.get("category")||"Todas",$=r.get("rating")||"0",F=r.get("sort")||"rating",D=r.get("view")||"list",I=r.get("viewMode")||"grid";o(d),l(v),u($),w(F),p(D==="map"),y(I)}catch(r){console.error("Error al procesar parámetros de URL:",r),o(""),l("Todas"),u("0"),w("rating"),p(!1),y("grid")}},[]),a.useEffect(()=>{async function r(){try{B(!0);const v=await te({query:s,category:t,rating:m,sortBy:x});_(v)}catch(d){console.error("Error al cargar los negocios:",d),_([])}finally{B(!1)}}r()},[s,t,m,x]),a.useEffect(()=>{try{const r=new URLSearchParams;s&&r.set("query",s),r.set("category",t),r.set("rating",m),r.set("sort",x),r.set("view",c?"map":"list"),r.set("viewMode",n),window.history.replaceState(null,"",`${window.location.pathname}?${r.toString()}`)}catch(r){console.error("Error al actualizar la URL:",r)}},[s,t,m,x,c,n]);const A=()=>{y(n==="grid"?"list":"grid")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 p-4 bg-muted/50 rounded-lg border",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[e.jsx(J,{className:"h-5 w-5 text-muted-foreground hidden md:inline"}),e.jsxs(N,{value:t,onValueChange:l,children:[e.jsx(k,{className:"w-full sm:w-[180px] bg-background",children:e.jsx(C,{placeholder:"Categoría"})}),e.jsx(S,{children:U.map(r=>e.jsx(i,{value:r,children:r},r))})]}),e.jsxs(N,{value:m,onValueChange:u,children:[e.jsxs(k,{className:"w-full sm:w-[170px] bg-background",children:[e.jsx(b,{className:"h-4 w-4 mr-1 inline-block text-yellow-500 fill-current"}),e.jsx(C,{placeholder:"Valoración"})]}),e.jsxs(S,{children:[e.jsx(i,{value:"0",children:"Cualquiera"}),e.jsx(i,{value:"4",children:"4+ Estrellas"}),e.jsx(i,{value:"3",children:"3+ Estrellas"}),e.jsx(i,{value:"2",children:"2+ Estrellas"}),e.jsx(i,{value:"1",children:"1+ Estrellas"})]})]}),e.jsxs(N,{value:x,onValueChange:w,children:[e.jsxs(k,{className:"w-full sm:w-[160px] bg-background",children:[e.jsx(Z,{className:"h-4 w-4 mr-1 inline-block"}),e.jsx(C,{placeholder:"Ordenar por"})]}),e.jsxs(S,{children:[e.jsx(i,{value:"rating",children:"Valoración"}),e.jsx(i,{value:"name",children:"Nombre (A-Z)"})]})]})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[!c&&e.jsx(f,{variant:n==="grid"?"default":"outline",onClick:A,className:"flex-1 md:flex-initial",children:n==="grid"?e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"mr-2 h-4 w-4"})," Cuadrícula"]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"mr-2 h-4 w-4"})," Lista"]})}),e.jsxs(f,{variant:c?"outline":"default",onClick:()=>{p(!1)},className:`flex-1 md:flex-initial ${c?"":"hidden"}`,children:[e.jsx(Y,{className:"mr-2 h-4 w-4"})," Resultados"]}),e.jsxs(f,{variant:c?"default":"outline",onClick:()=>p(!0),className:"flex-1 md:flex-initial",children:[e.jsx(se,{className:"mr-2 h-4 w-4"})," Mapa"]})]})]}),c?e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4 sr-only",children:"Vista de Mapa"}),e.jsx(L,{className:"h-[500px] flex items-center justify-center bg-muted text-muted-foreground rounded-lg overflow-hidden border",children:q?e.jsx(a.Suspense,{fallback:e.jsx(M,{className:"h-[500px] w-full rounded-lg"}),children:e.jsx(re,{businesses:g})}):e.jsx(M,{className:"h-[500px] w-full rounded-lg"})})]}):e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-6 sr-only",children:"Resultados"}),T?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(9)].map((r,d)=>e.jsx(M,{className:"h-72 rounded-lg"},d))}):g.length>0?n==="grid"?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map(r=>e.jsx(ae,{business:r},r.id))}):e.jsx("div",{className:"flex flex-col gap-4",children:g.map(r=>e.jsx(le,{business:r},r.id))}):e.jsxs("div",{className:"py-12 text-center",children:[e.jsx("p",{className:"text-lg text-muted-foreground",children:"No se encontraron negocios con los filtros seleccionados."}),e.jsx(f,{onClick:()=>{o(""),l("Todas"),u("0")},variant:"link",className:"mt-2",children:"Limpiar filtros"})]})]})]})}export{Ce as default};
