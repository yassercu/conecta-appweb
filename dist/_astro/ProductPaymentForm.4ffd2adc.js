import{j as e}from"./utils.4700314a.js";import{r as l}from"./index.ba1407fb.js";import{B as m}from"./button.24a09aef.js";import{I as T}from"./input.38b38b9a.js";import{L as f}from"./label.06ff4936.js";import{u as _,P as D,p as E}from"./PaymentForm.c5139f06.js";import{C as $}from"./card.76bb78a3.js";import{b as g}from"./data.a7dc0bf8.js";import{c as j}from"./createLucideIcon.5c021b84.js";import"./index.aa7e84ef.js";import"./index.7640c394.js";import"./index.2229f0e2.js";import"./index.5c5fab55.js";import"./index.bc2c71f5.js";import"./index.bc1dd6cd.js";import"./index.0a899574.js";import"./index.2ab59327.js";import"./index.6af11c90.js";import"./index.48db0fbf.js";import"./x.cbcf9f3b.js";import"./use-toast.3ee98f37.js";import"./credit-card.a6dcc7f6.js";import"./alert-dialog.6859f6df.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=[["path",{d:"M5 12h14",key:"1ays0h"}]],z=j("Minus",w);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],L=j("Plus",B);function ie({product:n,quantity:y=1,isOpen:N,onClose:P,onSuccess:v,onError:C,onQuantityChange:F,maxQuantity:a=n.maxQuantity??99,businessId:r}){const{toast:d}=_(),[s,M]=l.useState(y),[b,i]=l.useState(!1),p=n.price*s,t=r?g.find(o=>o.id===r):null;l.useEffect(()=>{t?(console.log("Negocio encontrado:",t),console.log("Teléfono del negocio:",t.phone)):r&&(console.error("No se encontró el negocio con ID:",r),console.log("Todos los IDs disponibles:",g.map(o=>o.id)))},[t,r]);const c=o=>{o>=1&&o<=a&&(M(o),F?.(o))},k=async o=>{try{d({title:"¡Pago exitoso!",description:"Tu pedido ha sido procesado correctamente."}),i(!1),v?.(o),P()}catch(S){const x=S;d({variant:"destructive",title:"Error en el pago",description:x.message}),C?.(x)}};if(!N)return null;const h=t?.phone?String(t.phone):"",u=t?.email?String(t.email):"";return console.log("Datos antes de renderizar PaymentForm:",{businessId:r,businessFound:!!t,businessPhone:h,businessContact:u}),e.jsxs(e.Fragment,{children:[e.jsx($,{className:"p-6 space-y-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(f,{children:"Cantidad"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(m,{variant:"outline",size:"icon",onClick:()=>c(s-1),disabled:s<=1,children:e.jsx(z,{className:"h-4 w-4"})}),e.jsx(T,{type:"number",value:s,onChange:o=>c(parseInt(o.target.value)||1),className:"w-20 text-center",min:1,max:a}),e.jsx(m,{variant:"outline",size:"icon",onClick:()=>c(s+1),disabled:s>=a,children:e.jsx(L,{className:"h-4 w-4"})})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Máximo disponible: ",a]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(f,{children:"Total"}),e.jsxs("div",{className:"text-2xl font-bold mt-1",children:["$",p.toFixed(2)]})]})]}),e.jsx(m,{className:"w-full",onClick:()=>i(!0),children:"Proceder al pago"})]})}),e.jsx(D,{isOpen:b,onClose:()=>i(!1),amount:p,currency:"USD",concept:`${s}x ${n.name}`,onPaymentComplete:k,metadata:{productId:n.id,quantity:s,type:"product_purchase"},paymentMethods:E,businessPhone:h,businessContact:u})]})}export{ie as ProductPaymentForm};
